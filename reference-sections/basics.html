<html><head></head><body><section id="basics"><h1>Basics</h1><section><h2>API style</h2><div class="content"><p>Most of the API follows REST principles, meaning each item has its own unique resource URL and can be read or modified via HTTP verbs:</p>
<ul>
<li>GET to read the item(s)</li>
<li>POST to create a new item, with a JSON message in the request body</li>
<li>PUT to modify the item, with a JSON message in the request body</li>
<li>DELETE to delete the item (note that logical deletion, or trashing, is supported for items like events, folders and channels)</li>
</ul>
<p>Note that the API also supports Socket.IO, for both calling API methods and receiving live notifications of changes to activity data. See <a href="#socketio">the dedicated section</a>.</p>
</div><aside><h4>Example request</h4>
<pre class="highlighted"><code class="language-http"><span class="request">GET <span class="string">/{channel-id}/events</span> HTTP/1.1</span>
<span class="attribute">Host</span>: <span class="string">{user-name}.pryv.io</span>
<span class="attribute">Authorization</span>: <span class="string">{access-token}</span></code></pre>
</aside></section><section><h2>Base URL</h2><div class="content"><p><code>https://{username}.pryv.io</code> (where <code>{username}</code> is the name of the user whose data you want to access)</p>
<p>Because Pryv potentially stores each user's data in a different location according to the user's choice, the API's base URL is unique for each user.</p>
</div></section><section><h2>Data format</h2><div class="content"><p>The API exchanges data with the client in JSON.</p>
</div><aside><h4>Example event</h4>
<pre class="highlighted"><code class="language-json">{
  "<span class="attribute">id</span>": <span class="value"><span class="string">"5051941d04b8ffd00500000d"</span></span>,
  "<span class="attribute">time</span>": <span class="value"><span class="number">1347864935.964</span></span>,
  "<span class="attribute">folderId</span>": <span class="value"><span class="string">"5058370ade44feaa03000015"</span></span>,
  "<span class="attribute">type</span>": <span class="value">{ "<span class="attribute">class</span>": <span class="value"><span class="string">"position"</span></span>, "<span class="attribute">format</span>": <span class="value"><span class="string">"wgs84"</span> </span>}</span>,
  "<span class="attribute">value</span>": <span class="value">{ "<span class="attribute">location</span>": <span class="value">{ "<span class="attribute">lat</span>": <span class="value"><span class="number">40.714728</span></span>, "<span class="attribute">lng</span>": <span class="value">-<span class="number">73.998672</span> </span>} </span>}</span>,
}</code></pre>
</aside></section><section><h2>Alternative request method</h2><div class="content"><p>Because we can't fathom out the crazy rationale behind <a href="https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS">HTTP access control (CORS) rules</a>, we offer web apps an alternative way to place POST, PUT and DELETE requests in the API by using <code>application/x-www-form-urlencoded</code> POST requests with the following fields (all optional):</p>
<ul>
<li><code>_method</code>: The HTTP override method to use (usually <code>PUT</code> or <code>DELETE</code>; <code>POST</code> is used if not set).</li>
<li><code>_auth</code>: The <code>Authorization</code> header value (alternative to sending the header itself).</li>
<li><code>_json</code>: Considered as the JSON request body if set (overriding all other body content, if any).</li>
</ul>
<p>This is intended for web apps only; if your app isn't running in browsers you should use regular requests.</p>
</div></section><section><h2>Common HTTP headers</h2><div class="content"><p>The following headers are included in every response:</p>
<ul>
<li><code>API-Version</code>: The version of the API in the form <code>{major}.{minor}.{revision}</code>.</li>
<li><code>Server-Time</code>: The current server time as a <a href="#data-structure-timestamp">timestamp</a>. Keeping reference of the server time is an absolute necessity to properly read and write event times.</li>
</ul>
</div></section><section><h2>Errors</h2><div class="content"><p>When an error occurs, the API returns a 4xx or 5xx status code, with the response body usually containing an <a href="#data-structure-error">error</a> object detailing the cause.</p>
</div><aside><h4>Example error response</h4>
<pre class="highlighted"><code class="language-json">{
  "<span class="attribute">id</span>": <span class="value"><span class="string">"invalid-access-token"</span></span>,
  "<span class="attribute">message</span>": <span class="value"><span class="string">"Cannot find access with token 'bad-token'."</span>
</span>}</code></pre>
</aside></section></section></body></html>