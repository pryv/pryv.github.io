<!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" property="og:description" content="Pryv API reference and resources for developers"><meta name="author" content="Pryv SA"><meta property="og:type" content="website"><meta name="image" property="og:image" content="/assets/images/logo-256.png"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Manage accesses | Pryv API</title><link rel="icon" href="/assets/images/favicon-black.ico" type="image/x-icon"><link rel="apple-touch-icon" sizes="120x120" href="/assets/images/apple-touch-icon-120x120-black.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/images/apple-touch-icon-152x152-black.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon-180x180-black.png"><!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,300,500,700,400italic|Roboto+Condensed:400,300,700"><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/docco.min.css"><link rel="stylesheet" type="text/css" href="/assets/fonts/ss-gizmo.min.css"><link rel="stylesheet" type="text/css" href="/assets/style.css"></head><body class="manage-accesses with-toc"><header id="page-header"><nav role="navigation" class="navbar navbar-default navbar-fixed-top"><div class="container-fluid"><div class="navbar-header"><a href="https://pryv.com" title="Pryv home" class="navbar-brand logo pryv-home"><img src="/assets/images/icon-home.svg" alt="Pryv home" height="50"></a><a href="/" title="Developers home" class="navbar-brand logo"><img src="/assets/images/logo-256-black.png" alt="Developers home"></a><button type="button" data-toggle="collapse" data-target="#main-nav" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div id="main-nav" class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Guides <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="/getting-started/">Getting started</a></li><li><a href="/concepts/">API concepts</a></li><li><a href="/guides/data-modelling/">Data modelling</a></li><li><a href="/guides/app-guidelines/">App guidelines</a></li><li><a href="/external-resources/">External resources</a></li></ul></li><li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Reference <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="/reference/">API reference</a></li><li><a href="/change-log/">API change log</a></li><li><a href="/event-types/">Event types</a></li><!--+menuItem('standardStructure')--></ul></li><li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">FAQ <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="/faq-api/">API</a></li><li><a href="/faq-infra/">Infrastructure</a></li></ul></li><!--lia(href='#') Blog--></ul><div class="navbar-right"><p class="navbar-text version"><a href="/change-log/" title="View change log">API version: <strong>1.4.23</strong></a></p></div></div></div></nav></header><div id="main-wrapper" class="container container-narrow"><div id="main"><h1 class="page-title">Manage accesses</h1><p>One of the core aspects of Pryv.io is the access management to the data, based on an active consent given by the data owner to others using accesses.</p>
<p>You can find the concepts behind the accesses in Pryv.io in the <a href="http://api.pryv.com/concepts/#accesses">API concepts</a> page.</p>
<h2 id="access-creation">Access creation</h2>
<p>To allow an other party to access the data, a user has to deliver an token linked to an access object in Pryv.io.</p>
<p>To do that, let&#39;s create our first access, using the creation method among the ones provided by the API and described in the <a href="http://pryv.github.io/reference/#accesses">Access methods reference</a>.</p>
<p>The object used as parameter contains some of the desired access fields. A list of all fields can be found in the <a href="http://pryv.github.io/reference/#data-structure-access">Access data structure reference</a>.</p>
<p>We&#39;ll create a shared access which is the default type, giving access to the previously created stream with <code>read</code> permissions.</p>
<pre><code class="lang-bash">curl -X POST \
     -H &#39;Content-Type: application/json&#39; \
     -H &#39;Authorization: cjsfxo173000111taf99gp3dv&#39; \
     -d &#39;{
         &quot;name&quot;: &quot;My first access&quot;,
         &quot;permissions&quot;: [
           {
            &quot;streamId&quot;: &quot;cjsfy56kv000311ta9dy121ni&quot;,
            &quot;level&quot;: &quot;read&quot;
           }
         ]
     }&#39; \
     https://jsmith.{domain}/accesses
</code></pre>
<p>The server will return the created access information, containing the most important token that will be used by whoever we allow to access data using this access.</p>
<pre><code class="lang-json">{
  &quot;meta&quot;: {
    &quot;apiVersion&quot;: &quot;1.3.38&quot;,
    &quot;serverTime&quot;: 1550843240.685
  },
  &quot;access&quot;: {
    &quot;name&quot;: &quot;My first access&quot;,
    &quot;permissions&quot;: [
      {
        &quot;streamId&quot;: &quot;cjsfy56kv000311ta9dy121ni&quot;,
        &quot;level&quot;: &quot;read&quot;
      }
    ],
    &quot;type&quot;: &quot;shared&quot;,
    &quot;token&quot;: &quot;cjsg40uzv000411ta8r4n7ax1&quot;,
    &quot;created&quot;: 1550843240.683,
    &quot;createdBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
    &quot;modified&quot;: 1550843240.683,
    &quot;modifiedBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
    &quot;id&quot;: &quot;cjsg40uzv000511tazp8k74db&quot;
  }
}
</code></pre>
<p>Now whoever or whatever algorithm or application query data on the user data storage accessible at <code>https://jsmith.{domain}</code> using this token (<code>cjsg40uzv000411ta8r4n7ax1</code>) will have read access to all events linked to the stream named <code>My Stream</code> that we created at the beginning of this tutorial.</p>
<p>Let&#39;s try that now.</p>
<h2 id="creating-more-data">Creating more data</h2>
<p>Before trying to use the shared access, let&#39;s add some more data in a different stream to visualize the access control in action.</p>
<pre><code class="lang-bash">curl -X POST \
     -H &#39;Content-Type: application/json&#39; \
     -H &#39;Authorization: cjsfxo173000111taf99gp3dv&#39; \
     -d &#39;{
         &quot;name&quot;: &quot;My second Stream&quot;
     }&#39; \
     https://jsmith.{domain}/streams
</code></pre>
<pre><code class="lang-json">{
  &quot;meta&quot;: {
    &quot;apiVersion&quot;: &quot;1.3.38&quot;,
    &quot;serverTime&quot;: 1550843657.516
  },
  &quot;stream&quot;: {
    &quot;name&quot;: &quot;My second Stream&quot;,
    &quot;parentId&quot;: null,
    &quot;created&quot;: 1550843657.513,
    &quot;createdBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
    &quot;modified&quot;: 1550843657.513,
    &quot;modifiedBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
    &quot;id&quot;: &quot;cjsg49smi000114tao2ritqsj&quot;
  }
}
</code></pre>
<p>The second streams is created. Note the <code>id</code> of this new stream that will be used in the following query.</p>
<p>Using this new <code>streamId</code> let&#39;s create another event, this time with a more complex type like the blood pressure type <code>blood-pressure/mmhg-bpm</code>.</p>
<p>The reference for this default data type can be found <a href="http://pryv.github.io/event-types/#blood-pressure">here</a>.</p>
<pre><code class="lang-bash">curl -X POST \
     -H &#39;Content-Type: application/json&#39; \
     -H &#39;Authorization: cjsfxo173000111taf99gp3dv&#39; \
     -d &#39;{
         &quot;streamId&quot;: &quot;cjsg49smi000114tao2ritqsj&quot;,
         &quot;type&quot;: &quot;blood-pressure/mmhg-bpm&quot;,
         &quot;description&quot;: &quot;My blood pressure&quot;,
         &quot;time&quot;: 1549791135.052,
         &quot;content&quot;: {
               &quot;systolic&quot;: 141,
               &quot;diastolic&quot;: 82
           }
     }&#39; \
     https://jsmith.{domain}/events
</code></pre>
<p>The server returns the new event with all its necessary fields filled.</p>
<pre><code class="lang-json">{
  &quot;meta&quot;: {
    &quot;apiVersion&quot;: &quot;1.3.38&quot;,
    &quot;serverTime&quot;: 1550844023.884
  },
  &quot;event&quot;: {
    &quot;streamId&quot;: &quot;cjsg49smi000114tao2ritqsj&quot;,
    &quot;type&quot;: &quot;blood-pressure/mmhg-bpm&quot;,
    &quot;description&quot;: &quot;My blood pressure&quot;,
    &quot;time&quot;: 1549791135.052,
    &quot;content&quot;: {
      &quot;systolic&quot;: 141,
      &quot;diastolic&quot;: 82
    },
    &quot;tags&quot;: [],
    &quot;created&quot;: 1550844023.879,
    &quot;createdBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
    &quot;modified&quot;: 1550844023.879,
    &quot;modifiedBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
    &quot;id&quot;: &quot;cjsg4hnbe000611taaj2vmjua&quot;
  }
}
</code></pre>
<h2 id="getting-data-using-a-shared-access">Getting data using a shared access</h2>
<p>It&#39;s now time to use the previously obtained shared access token (<code>cjsg40uzv000411ta8r4n7ax1</code>).</p>
<p>Let&#39;s change the <code>Authorization</code> header in the REST query and see that only the note event is returned.</p>
<pre><code class="lang-bash">curl -X GET \
     -H &#39;Content-Type: application/json&#39; \
     -H &#39;Authorization: cjsg40uzv000411ta8r4n7ax1&#39; \
     https://jsmith.{domain}/events
</code></pre>
<p>The server returns the following list of one event.</p>
<pre><code class="lang-json">{
  &quot;events&quot;: [
    {
      &quot;streamId&quot;: &quot;cjsfy56kv000311ta9dy121ni&quot;,
      &quot;type&quot;: &quot;note/txt&quot;,
      &quot;description&quot;: &quot;My note event&quot;,
      &quot;content&quot;: &quot;This is the content of our note&quot;,
      &quot;time&quot;: 1550841167.72,
      &quot;tags&quot;: [],
      &quot;created&quot;: 1550841167.72,
      &quot;createdBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
      &quot;modified&quot;: 1550841167.721,
      &quot;modifiedBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
      &quot;id&quot;: &quot;cjsg2sfhq000014taogk4y0gv&quot;
    }
  ],
  &quot;meta&quot;: { &quot;apiVersion&quot;: &quot;1.3.38&quot;, &quot;serverTime&quot;: 1550844293.294 }
}
</code></pre>
<p>The blood pressure event is not returned because it is not contained in the stream to which we have an access for.</p>
<p>If we do the same query using the personal token of John Smith, we&#39;ll see all existing events.</p>
<pre><code class="lang-bash">curl -X GET \
     -H &#39;Content-Type: application/json&#39; \
     -H &#39;Authorization: cjsfxo173000111taf99gp3dv&#39; \
     https://jsmith.{domain}/events
</code></pre>
<pre><code class="lang-json">{
  &quot;events&quot;: [
    {
      &quot;streamId&quot;: &quot;cjsfy56kv000311ta9dy121ni&quot;,
      &quot;type&quot;: &quot;note/txt&quot;,
      &quot;description&quot;: &quot;My note event&quot;,
      &quot;content&quot;: &quot;This is the content of our note&quot;,
      &quot;time&quot;: 1550841167.72,
      &quot;tags&quot;: [],
      &quot;created&quot;: 1550841167.72,
      &quot;createdBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
      &quot;modified&quot;: 1550841167.721,
      &quot;modifiedBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
      &quot;id&quot;: &quot;cjsg2sfhq000014taogk4y0gv&quot;
    },
    {
      &quot;streamId&quot;: &quot;cjsg49smi000114tao2ritqsj&quot;,
      &quot;type&quot;: &quot;blood-pressure/mmhg-bpm&quot;,
      &quot;description&quot;: &quot;My blood pressure&quot;,
      &quot;time&quot;: 1549791135.052,
      &quot;content&quot;: {
        &quot;systolic&quot;: 141,
        &quot;diastolic&quot;: 82
      },
      &quot;tags&quot;: [],
      &quot;created&quot;: 1550844023.879,
      &quot;createdBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
      &quot;modified&quot;: 1550844023.879,
      &quot;modifiedBy&quot;: &quot;cjsfxo17f000211tair7v6atb&quot;,
      &quot;id&quot;: &quot;cjsg4hnbe000611taaj2vmjua&quot;
    }
  ],
  &quot;meta&quot;: { &quot;apiVersion&quot;: &quot;1.3.38&quot;, &quot;serverTime&quot;: 1550844424.979 }
}
</code></pre>
<p>The event list contains the 2 events that were created during this tutorial, showing that the access control effectively filtered the events returned by the server based on the actual access rights given by the data owner.</p>
</div><nav id="toc"></nav></div><footer id="page-footer"><nav class="navbar navbar-default"><div class="container-fluid"><div id="footer-nav"><ul class="nav navbar-nav"><li><a href="mailto:developers@pryv.com">Send a message</a></li><li><a href="https://github.com/pryv">GitHub</a></li><li><a href="https://pryv.com">pryv.com</a></li></ul></div></div></nav></footer><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script><script src="/assets/bootstrap.min.js"></script><script src="/assets/js/toc.min.js"></script><!-- TOC generation--><script>jQuery(document).ready(function($) {
  // Header is about 51 pixels. This equals to 'header + fuzz', fuzz was
  // determined experimentally.
  var offset = 100;

  // Display TOC on the left side of the page.
  $('#toc').toc({
    selector: '#main h1:not(.page-title),#main h2,#main h3',
    ulClass: 'nav'
  });

  // Synchronise scroll/click motion with TOC display.
  $(document).ready(function() {
    // NOTE This is done at onLoad since we need to wait for all CSS
    // to appear.
    $('body').scrollspy({
      target: '#toc',
      offset: offset
    });
  });
});
</script><!-- Code blocks highlighting--><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();
</script><!-- Google Analytics--><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-36589447-2']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script><!-- Sales-Wings--><script type="text/javascript" id="SW-fd71dffa-76e8-479e-a37b-6e915b97b023"></script><script>!function(){function a(){var a=document.createElement("script");
a.type="text/javascript",a.async=1,a.src="//go.saleswingsapp.com/assets/javascripts/sw/fd71dffa-76e8-479e-a37b-6e915b97b023";
var b=document.getElementById("SW-fd71dffa-76e8-479e-a37b-6e915b97b023");
b.parentNode.insertBefore(a,b)}window.attachEvent?window.attachEvent("onload",a):window.addEventListener("load",a,0)}();</script></body></html>