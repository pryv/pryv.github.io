<!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="UTF-8"><title>Pryv API - Reference</title><meta name="description" content="TODO"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="style.css"><link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap-responsive.min.css"><link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=PT+Sans"><link rel="stylesheet" type="text/css" href="fonts/stylesheet.css"><script src="scripts/modernizr.min.js"></script><script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script><script src="scripts/jquery.toc.min.js"></script><script src="bootstrap/js/bootstrap.min.js"></script><link rel="stylesheet" type="text/css" href="highlight.css"><script src="highlight/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();
</script><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-36589447-2']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script></head><body class="with-toc with-examples"><header id="page-header" class="navbar navbar-fixed-top"><div class="navbar-inner"><a href="dev-index.html" class="brand">Pryv</a><a data-toggle="collapse" data-target=".nav-collapse" class="btn btn-navbar"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><div class="nav-collapse collapse"><ul class="nav"><li><a href="about.html">About</a></li><li><a href="concepts.html">Concepts</a></li><li><a href="reference.html">API reference</a></li><li><a href="event-typez.html">Event types</a></li><li><a href="app-access.html">App access</a></li><li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">More <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="apps-and-services.html">Pryv apps and services</a></li><li><a href="code-libraries.html">Code libraries</a></li></ul></li><!--li.dropdown<a href="#" data-toggle="dropdown" class="dropdown-toggle">Guides <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="#">Getting started</a></li><li><a href="#">Data modeling</a></li></ul>--><!--li.dropdown<a href="#" data-toggle="dropdown" class="dropdown-toggle">Reference <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="reference.html">API</a></li><li><a href="event-typez.html">Event types</a></li><li><a href="standard-structure.html">Standard data structure</a></li><li><a href="app-access.html">App authorization</a></li></ul>--><!--li<a href="#">Blog</a>--></ul></div><div class="nav-header pull-right"><div class="version">API version: <strong>0.7.0WIP</strong></div></div></div></header><div id="main-wrapper" class="container"><div id="main" class="row"><section id="basics"><h1>Basics</h1><section><h2>API style</h2><div class="content"><p>Most of the API follows REST principles, meaning each item has its own unique resource URL and can be read or modified via HTTP verbs:</p>
<ul>
<li><strong>GET</strong> to read the item(s)</li>
<li><strong>POST</strong> to create a new item, with a JSON message in the request body</li>
<li><strong>PUT</strong> to modify the item, with a JSON message in the request body</li>
<li><strong>DELETE</strong> to delete the item (note that logical deletion, or trashing, is supported for items like events and streams)</li>
</ul>
<p>The API also supports web sockets via Socket.IO, for both calling API methods and receiving live notifications of changes to activity data. See <a href="#socketio">the dedicated section</a>.</p>
</div><aside><h4>Example request</h4>
<pre><code class="language-http">GET /events HTTP/1.1
Host: {username}.pryv.io
Authorization: {access-token}</code></pre>
</aside></section><section><h2>API endpoints</h2><div class="content"><p><code>https://{username}.pryv.io</code> (where <code>{username}</code> is the name of the user whose data you want to access)</p>
<p>Because Pryv potentially stores each user&#39;s data in a different location according to the user&#39;s choice, the API&#39;s base URL is unique for each user.</p>
</div></section><section><h2>Data format</h2><div class="content"><p>The API exchanges data with the client in JSON.</p>
</div><aside><h4>Example event</h4>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;5051941d04b8ffd00500000d&quot;,
  &quot;time&quot;: 1347864935.964,
  &quot;streamId&quot;: &quot;5058370ade44feaa03000015&quot;,
  &quot;type&quot;: &quot;position/wgs84&quot;,
  &quot;content&quot;: { &quot;latitude&quot;: 40.714728, &quot;longitude&quot;: -73.998672 },
}</code></pre>
</aside></section><section><h2>Alternative HTTP request method</h2><div class="content"><p>Because we can&#39;t fathom out the crazy rationale behind <a href="https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS">HTTP access control (CORS) rules</a>, we offer web apps an alternative way to place POST, PUT and DELETE requests in the API by using <code>application/x-www-form-urlencoded</code> POST requests with the following fields (all optional):</p>
<table class="definitions"><tr><th><p><code>_method</code></p>
</th><td><p>The HTTP override method to use (usually <code>PUT</code> or <code>DELETE</code>; <code>POST</code> is used if not set).</p>
</td></tr><tr><th><p><code>_auth</code></p>
</th><td><p>The <code>Authorization</code> header value (alternative to sending the header itself).</p>
</td></tr><tr><th><p><code>_json</code></p>
</th><td><p>Considered as the JSON request body if set (overriding all other body content, if any).</p>
</td></tr></table><p>This is intended for web apps only; if your app isn&#39;t running in browsers you should use regular requests.</p>
</div></section><section><h2>Common response metadata</h2><div class="content"><p>The following metadata is included in every response:</p>
<table class="definitions"><tr><th><p><code>meta.apiVersion</code></p>
</th><td><p>The version of the API in the form <code>{major}.{minor}.{revision}</code>. Mirrored in HTTP header <code>API-Version</code>.</p>
</td></tr><tr><th><p><code>meta.serverTime</code></p>
</th><td><p>The current server time as a <a href="#data-structure-timestamp">timestamp</a>. Keeping reference of the server time is an absolute necessity to properly read and write event times.</p>
</td></tr></table></div></section><section><h2>Errors</h2><div class="content"><p>When an error occurs, the API returns a response with an <code>error</code> object (see <a href="#data-structure-error">error</a>) detailing the cause. (Over HTTP, the response status is set to 4xx or 5xx.) In this documentation, errors are identified by their <code>id</code>.</p>
</div><aside><h4>Example error response</h4>
<pre><code class="language-json">{
  &quot;error&quot;: {
    &quot;id&quot;: &quot;invalid-access-token&quot;,
    &quot;message&quot;: &quot;Cannot find access with token &#39;bad-token&#39;.&quot;
  }
}</code></pre>
</aside></section></section><section id="methods"><h1>API methods</h1><div class="intro"><p>Not all methods are available over Socket.IO for the moment; for those that are, we indicate the method id next to the HTTP verb and path.</p>
</div><section><h2>Preliminary information</h2><section><h3>Authorization</h3><div class="content"><p>All requests for retrieving and manipulating activity data must carry a valid <a href="#data-structure-access">access token</a> in the HTTP <code>Authorization</code> header or, alternatively, in the query string&#39;s <code>auth</code> parameter.  (You get the token by using one of the <a href="app-access.html">access SDKs</a> or from sharing.)</p>
</div><aside><h4>Example with <code>Authorization</code> header</h4>
<pre><code class="language-http">GET /events HTTP/1.1
Host: yacinthe.pryv.io
Authorization: {access-token}</code></pre>
<h4>Example with <code>auth</code> query string parameter</h4>
<pre><code class="language-http">GET /events?auth={access-token} HTTP/1.1
Host: yacinthe.pryv.io</code></pre>
</aside></section><section><h3>Common errors</h3><div class="content"><h4>Bad request</h4>
<p><span class="label http">HTTP status</span> <code>400</code></p>
<ul>
<li><code>invalid-request-structure</code>: The request&#39;s structure is not that expected. This can happen e.g. with invalid JSON syntax, or when using an unexpected multipart structure for uploading file attachments.</li>
<li><code>invalid-parameters-format</code>: The request&#39;s parameters do not follow the expected format. The error&#39;s <code>data</code> contains an array of validation errors.</li>
<li><code>unknown-event</code>: The referenced event(s) can&#39;t be found. If relevant, the unknown items&#39; ids are listed as an array in the error&#39;s <code>data.unknownIds</code>.</li>
<li><code>unknown-stream</code>: The referenced stream(s) can&#39;t be found. If relevant, the unknown items&#39; ids are listed as an array in the error&#39;s <code>data.unknownIds</code>.</li>
<li><code>unknown-tag</code>: The referenced typed tag(s) can&#39;t be found. If relevant, the unknown items&#39; ids are listed as an array in the error&#39;s <code>data.unknownIds</code>.</li>
</ul>
<h4>Unauthorized</h4>
<p><span class="label http">HTTP status</span> <code>401</code></p>
<ul>
<li><code>invalid-access-token</code>: The data access token is missing or invalid.</li>
</ul>
<h4>Forbidden</h4>
<p><span class="label http">HTTP status</span> <code>403</code></p>
<p>The given access token does not grant permission for this operation. See <a href="#data-structure-access">accesses</a> for more details about accesses and permissions.</p>
<h4>Not found</h4>
<p><span class="label http">HTTP status</span> <code>404</code></p>
<ul>
<li><code>unknown-event</code>: The event can&#39;t be found.</li>
<li><code>unknown-stream</code>: The activity stream can&#39;t be found.</li>
<li><code>unknown-tag</code>: The tag can&#39;t be found.</li>
<li><code>unknown-attachment</code>: The attached file can&#39;t be found for the specified event.</li>
</ul>
<h4>Moved</h4>
<p><span class="label http">HTTP status</span> <code>301</code></p>
<ul>
<li><code>user-account-relocated</code>: The user has relocated her account to another Pryv server. Both the <code>Location</code> header and the error&#39;s <code>data</code> contain the equivalent URL pointing to the physical server now hosting the user&#39;s account. Note that this error can only occur between the moment the account is relocated and the moment your DNS is updated with the new server. So we&#39;re stretching the HTTP convention a little, in that the returned URL should not be used permanently (only until <code>{username}.pryv.io</code> points to the correct server again). You can decide whether you keep it for the duration of the session (if you have such a thing), for N hours, etc.</li>
</ul>
<h4>Payment required</h4>
<p><span class="label http">HTTP status</span> <code>402</code></p>
<ul>
<li><code>user-intervention-required</code>: We cannot serve the request at the moment, because the user&#39;s account has exceeded the limits of its plan. The user must log into Pryv to fix her account.</li>
</ul>
</div></section></section><section><h2>Events</h2><div class="intro"><p>Methods to retrieve and manipulate <a href="#data-structure-event">events</a>.</p>
</div><section class="method"><h3>Get events</h3><div class="content"><p><span class="label http">HTTP</span> <code>GET /events</code> <span class="label method-id">id</span> <code>events.get</code></p>
<p>Queries accessible events.</p>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>fromTime</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label optional">optional</span><br>
The start time of the timeframe you want to retrieve events for. Default is 24 hours before <code>toTime</code> if the latter is set; otherwise it is not taken into account.</p>
</td></tr><tr><th><p><code>toTime</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label optional">optional</span><br>
The end time of the timeframe you want to retrieve events for. Default is the current time. Note: events are considered to be within a given timeframe based on their <code>time</code> only (<code>duration</code> is not considered).</p>
</td></tr><tr><th><p><code>streams</code></p>
</th><td><p><span class="type">array of <a href="#data-structure-identity">identity</a></span>
<span class="label optional">optional</span><br>
If set, only events assigned to the specified streams and their sub-streams will be returned. By default, all accessible events are returned regardless of their stream.</p>
</td></tr><tr><th><p><code>tags</code></p>
</th><td><p><span class="type">array of strings</span>
<span class="label optional">optional</span><br>
If set, only events assigned to all of the listed tags will be returned.</p>
</td></tr><tr><th><p><code>running</code></p>
</th><td><p><span class="type">boolean</span>
<span class="label optional">optional</span><br>
If <code>true</code>, only running period events will be returned.</p>
</td></tr><tr><th><p><code>sortAscending</code></p>
</th><td><p><span class="type"><code>true</code>|<code>false</code></span>
<span class="label optional">optional</span><br>
If <code>true</code>, events will be sorted from oldest to newest. Default: false (sort descending).</p>
</td></tr><tr><th><p><code>skip</code></p>
</th><td><p><span class="type">number</span>
<span class="label optional">optional</span><br>
The number of items to skip in the results.</p>
</td></tr><tr><th><p><code>limit</code></p>
</th><td><p><span class="type">number</span>
<span class="label optional">optional</span><br>
The number of items to return in the results. A default value of 20 items is used if no other range limiting parameter is specified (<code>fromTime</code>, <code>toTime</code>).</p>
</td></tr><tr><th><p><code>state</code></p>
</th><td><p><span class="type"><code>default</code>|<code>trashed</code>|<code>all</code></span>
<span class="label optional">optional</span><br>
Indicates what items to return depending on their state. By default, only items that are not in the trash are returned; <code>trashed</code> returns only items in the trash, while <code>all</code> return all items regardless of their state.</p>
</td></tr><tr><th><p><code>modifiedSince</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label optional">optional</span><br>
If specified, only events modified since that time will be returned.</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>events</code></p>
</th><td><p><span class="type">array of <a href="#data-structure-event">events</a></span><br>
The accessible events ordered by time (see <code>sortAscending</code> above).</p>
</td></tr></table></div><aside><h4>cURL example</h4>
<pre><code class="language-bash">curl -i https://{username}.pryv.io/events?auth={access-token}</code></pre>
</aside></section><section class="method"><h3>Create event</h3><div class="content"><p><span class="label http">HTTP</span> <code>POST /events</code> <span class="label method-id">id</span> <code>events.create</code></p>
<p>Records a new event. It is recommended that events recorded this way are completed events, i.e. either period events with a known duration or mark events. To start a running period event, use <a href="#TODO">Start period</a> instead.</p>
<p>In addition to JSON, this request accepts standard multipart/form-data content to support the creation of event with attached files in a single request. When sending a multipart request, one content part must hold the JSON for the new event and all other content parts must be the attached files.</p>
<h4>Parameters</h4>
<p>The new event&#39;s data: see <a href="#data-structure-event">Event</a>.</p>
<h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>201 Created</code></p>
<table class="definitions"><tr><th><p><code>event</code></p>
</th><td><p><span class="type"><a href="#data-structure-event">event</a></span><br>
The created event.</p>
</td></tr><tr><th><p><code>stoppedId</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span><br>
Only in <code>singleActivity</code> streams. If set, indicates the id of the previously running period event that was stopped as a consequence of inserting the new event.</p>
</td></tr></table><h4>Specific errors</h4>
<ul>
<li><code>invalid-operation</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: The stream is in the trash, and we prevent the recording of new events into trashed streams.</li>
<li><code>periods-overlap</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: Only in <code>singleActivity</code> streams: the new event overlaps existing period events. The overlapped events&#39; ids are listed as an array in the error&#39;s <code>data.overlappedIds</code>.</li>
</ul>
</div><aside><h4>cURL example, post a mass record of 90Kg</h4>
<pre><code class="language-bash">curl -i -H &quot;Content-Type: application/json&quot; -X POST -d &#39;{&quot;streamId&quot;:&quot;{stream-id}&quot;, &quot;type&quot;: &quot;mass/kg&quot;, &quot;content&quot;: 90}&#39; https://{username}.pryv.io/events?auth={access-token}</code></pre>
<p>TODO: multipart/form-data example</p>
</aside></section><section class="method"><h3>Start period</h3><div class="content"><p><span class="label http">HTTP</span> <code>POST /events/start</code> <span class="label method-id">id</span> <code>events.start</code></p>
<p>Starts a new period event. This is equivalent to starting an event with a null <code>duration</code>. In <code>singleActivity</code> streams, also stops the previously running period event if any. See <a href="#TODO">Create event</a> for details.</p>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">curl -i -H &quot;Content-Type: application/json&quot; -X POST -d &#39;{&quot;streamId&quot;:&quot;{stream-id}&quot;}&#39; https://{username}.pryv.io/events/start?auth={access-token}</code></pre>
</aside></section><section class="method"><h3>Stop period</h3><div class="content"><p><span class="label http">HTTP</span> <code>POST /events/stop</code> <span class="label method-id">id</span> <code>events.stop</code></p>
<p>Stops a previously running period event. In <code>singleActivity</code> streams, which guarantee that only one event is running at any given time, that event is automatically determined; for regular streams, the event to stop must be specified.</p>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>streamId</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span><br>
The id of the <code>singleActivity</code> stream in which to stop any running event. Either this or <code>id</code> must be specified.</p>
</td></tr><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span><br>
The id of the event to stop. Either this or <code>streamId</code> must be specified.</p>
</td></tr><tr><th><p><code>time</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label optional">optional</span><br>
The stop time. Default: now.</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>stoppedId</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span><br>
Only in <code>singleActivity</code> streams. The id of the previously running period event that was stopped, or null if no running event was found.</p>
</td></tr></table><h4>Specific errors</h4>
<ul>
<li><code>unknown-event</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: The specified event cannot be found.</li>
<li><code>invalid-operation</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: The specified event is not a running period event.</li>
<li><code>missing-parameter</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: No event was specified and the specified stream is not a <code>singleActivity</code> stream (so that there can be more than one running event).</li>
</ul>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section><section class="method"><h3>Update event</h3><div class="content"><p><span class="label http">HTTP</span> <code>PUT /events/{event-id}</code> <span class="label method-id">id</span> <code>events.update</code></p>
<p>Modifies the event&#39;s attributes.</p>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label http">HTTP</span> Set in request path<br>
The id of the event.</p>
</td></tr><tr><th><p><code>update</code></p>
</th><td><p><span class="type">object</span>
<span class="label http">HTTP</span> = request body<br>
New values for the event&#39;s fields: see <a href="#data-structure-event">event</a>. All fields are optional, and only modified values must be included. TODO: example</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>event</code></p>
</th><td><p><span class="type"><a href="#data-structure-event">event</a></span><br>
The updated event.</p>
</td></tr><tr><th><p><code>stoppedId</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span><br>
Only in <code>singleActivity</code> streams. If set, indicates the id of the previously running period event that was stopped as a consequence of modifying the event.</p>
</td></tr></table><h4>Specific errors</h4>
<ul>
<li><code>invalid-operation</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: Returned for period events, if attempting to set the event&#39;s duration to <code>undefined</code> (i.e. still running) while one or more other period events were recorded after it. The error&#39;s <code>data.conflictingPeriodId</code> provides the id of the closest conflicting event.</li>
<li><code>periods-overlap</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: Returned for period events, if attempting to change the event&#39;s duration to a value that causes an overlap with one or more subsequent period event(s). The overlapped events&#39; ids are listed as an array in the error&#39;s <code>data.overlappedIds</code>.</li>
</ul>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section><section class="method"><h3>Add attached file(s) to event</h3><div class="content"><p><span class="label http">HTTP</span> <code>POST /events/{event-id}</code></p>
<p>HTTP-only. Adds one or more file attachments to the event. This request expects standard multipart/form-data content, with all content parts being the attached files.</p>
<h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">curl -i -F &#39;event={&quot;streamId&quot;:&quot;ePm4KDmxr&quot;,&quot;type&quot;:&quot;picture/attached&quot;}&#39;  -F &#39;file=@-&#39; https://{username}.pryv.io/events?auth={token} &lt; {filename}</code></pre>
<p>...or...</p>
<pre><code class="language-bash">curl -i -F &#39;event={&quot;streamId&quot;:&quot;ePm4KDmxr&quot;,&quot;type&quot;:&quot;picture/attached&quot;}&#39;  -F &quot;file=@{filename}&quot; https://{username}.pryv.io/events?auth={token}</code></pre>
</aside></section><section class="method"><h3>Delete event</h3><div class="content"><p><span class="label http">HTTP</span> <code>DELETE /events/{event-id}</code> <span class="label method-id">id</span> <code>events.delete</code></p>
<p>Trashes or deletes the specified event, depending on its current state:</p>
<ul>
<li>If the event is not already in the trash, it will be moved to the trash (i.e. flagged as <code>trashed</code>)</li>
<li>If the event is already in the trash, it will be irreversibly deleted (including all its attached files, if any).</li>
</ul>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label http">HTTP</span> Set in request path<br>
The id of the event.</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>204 No content</code></p>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section><section class="method"><h3>Get attached file</h3><div class="content"><p><span class="label http">HTTP</span> <code>GET /events/{event-id}/{file name}</code></p>
<p>HTTP-only. Gets the attached file.</p>
<h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section><section class="method"><h3>Delete attached file</h3><div class="content"><p><span class="label http">HTTP</span> <code>DELETE /events/{event-id}/{filename}</code> <span class="label method-id">id</span> <code>events.deleteAttachedFile</code></p>
<p>Irreversibly deletes the attached file.</p>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label http">HTTP</span> Set in request path<br>
The id of the event.</p>
</td></tr><tr><th><p><code>fileName</code></p>
</th><td><p><span class="type">object</span>
<span class="label http">HTTP</span> Set in request path<br>
The attached file&#39;s name.</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>204 No content</code></p>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section></section><section><h2>Streams</h2><div class="intro"><p>Methods to retrieve and manipulate <a href="#data-structure-stream">streams</a>.</p>
</div><section class="method"><h3>Get streams</h3><div class="content"><p><span class="label http">HTTP</span> <code>GET /streams</code> <span class="label method-id">id</span> <code>streams.get</code></p>
<p>Gets the accessible streams, either from the root level or only descending from a specified parent stream.</p>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>parentId</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label optional">optional</span><br>
The id of the parent stream to use as root for the request. Default: <code>null</code> (returns all accessible streams from the root level).</p>
</td></tr><tr><th><p><code>state</code></p>
</th><td><p><span class="type"><code>default</code>|<code>all</code></span>
<span class="label optional">optional</span><br>
Indicates what items to return depending on their state. By default, only items that are not in the trash are returned; <code>all</code> return all items regardless of their state.</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>streams</code></p>
</th><td><p><span class="type">array of <a href="#data-structure-stream">streams</a></span><br>
The tree of the accessible streams, sorted by name.</p>
</td></tr></table><h4>Specific errors</h4>
<ul>
<li><code>unknown-stream</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: The specified parent stream can&#39;t be found.</li>
</ul>
</div><aside><h4>cURL example</h4>
<p>Create a sub-stream &quot;diastolic&quot; of &quot;heart&quot;</p>
<pre><code class="language-bash">curl -i -H &quot;Content-Type: application/json&quot; -X POST -d &#39;
{&quot;id&quot;:&quot;diastolic&quot;,
 &quot;name&quot;: &quot;Diastolic pressure&quot;,
 &quot;parentId&quot;: &quot;heart&quot;
}&#39; &quot;https://$USERNAME.pryv.io/streams?auth=$TOKEN&quot;</code></pre>
</aside></section><section class="method"><h3>Create stream</h3><div class="content"><p><span class="label http">HTTP</span> <code>POST /streams</code> <span class="label method-id">id</span> <code>streams.create</code></p>
<p>Creates a new stream at the root level or as a child stream to the specified stream.</p>
<h4>Body parameters</h4>
<p>The new stream&#39;s data: see <a href="#data-structure-stream">activity stream</a>.</p>
<h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>201 Created</code></p>
<table class="definitions"><tr><th><p><code>stream</code></p>
</th><td><p><span class="type"><a href="#data-structure-stream">stream</a></span><br>
The created stream.</p>
</td></tr></table><h4>Specific errors</h4>
<ul>
<li><code>item-id-already-exists</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: A stream already exists with the same id.</li>
<li><code>item-name-already-exists</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: A sibling stream already exists with the same name.</li>
<li><code>invalid-item-id</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: Occurs if trying to set the id to an invalid value (e.g. a reserved word like <code>&quot;null&quot;</code>).</li>
</ul>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section><section class="method"><h3>Update stream</h3><div class="content"><p><span class="label http">HTTP</span> <code>PUT /streams/{stream-id}</code> <span class="label method-id">id</span> <code>streams.update</code></p>
<p>Modifies the activity stream&#39;s attributes.</p>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label http">HTTP</span> Set in request path<br>
The id of the stream.</p>
</td></tr><tr><th><p><code>update</code></p>
</th><td><p><span class="type">object</span>
<span class="label http">HTTP</span> = request body<br>
New values for the stream&#39;s fields: see <a href="#data-structure-stream">activity stream</a>. All fields are optional, and only modified values must be included.</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>stream</code></p>
</th><td><p><span class="type"><a href="#data-structure-stream">stream</a></span><br>
The updated stream (without child streams).</p>
</td></tr></table><h4>Specific errors</h4>
<ul>
<li><code>unknown-stream</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: The specified parent stream&#39;s id is unknown.</li>
<li><code>item-name-already-exists</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: A sibling stream already exists with the same name.</li>
</ul>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section><section class="method"><h3>Delete stream</h3><div class="content"><p><span class="label http">HTTP</span> <code>DELETE /streams/{stream-id}</code> <span class="label method-id">id</span> <code>streams.delete</code></p>
<p>Trashes or deletes the specified stream, depending on its current state:</p>
<ul>
<li>If the stream is not already in the trash, it will be moved to the trash (i.e. flagged as <code>trashed</code>)</li>
<li>If the stream is already in the trash, it will be irreversibly deleted with its possible descendants. If events exist that refer to the deleted item(s), you must indicate how to handle them with the parameter <code>mergeEventsWithParent</code>..</li>
</ul>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label http">HTTP</span> Set in request path<br>
The id of the stream.</p>
</td></tr><tr><th><p><code>mergeEventsWithParent</code></p>
</th><td><p><span class="type"><code>true</code>|<code>false</code></span><br>
Required if actually deleting the item and if it (or any of its descendants) has linked events, ignored otherwise. If <code>true</code>, the linked events will be assigned to the parent of the deleted item; if <code>false</code>, the linked events will be deleted.</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>204 No content</code></p>
<h4>Specific errors</h4>
<ul>
<li><code>missing-parameter</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: There are events referring to the deleted items and the <code>mergeEventsWithParent</code> parameter is missing.</li>
</ul>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section></section><section><h2><a id="activity-accesses"></a>Accesses</h2><div class="intro"><p>While full access management is reserved for trusted apps, any app can retrieve and manage shared accesses depending on its own permissions. All methods here only deal with shared accesses whose permissions are a subset of that linked to the token used for the requests. (You&#39;ll get a <code>403 Forbidden</code> error if trying to touch other types of accesses, or shared accesses with greater permissions.)</p>
</div><section class="method"><h3>Get accesses</h3><div class="content"><p><span class="label http">HTTP</span> <code>GET /accesses</code> <span class="label method-id">id</span> <code>accesses.get</code></p>
<p>Gets all manageable shared accesses.</p>
<h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>accesses</code></p>
</th><td><p><span class="type">array of <a href="#data-structure-access">accesses</a></span><br>
All manageable shared accesses in the user&#39;s account, ordered by name.</p>
</td></tr></table></div><aside><h4>cURL example</h4>
<pre><code class="language-bash">curl -i -H &quot;Authorization: {access-token}&quot; https://{username}.pryv.io/accesses</code></pre>
</aside></section><section class="method"><h3>Create access</h3><div class="content"><p><span class="label http">HTTP</span> <code>POST /accesses</code> <span class="label method-id">id</span> <code>accesses.create</code></p>
<p>Creates a new shared access. You can only create accesses whose permissions are a subset of those linked to your own access token.</p>
<h4>Parameters</h4>
<p>The new access&#39;s data: see <a href="#data-structure-access">access</a>.</p>
<h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>201 Created</code></p>
<table class="definitions"><tr><th><p><code>access</code></p>
</th><td><p><span class="type"><a href="#data-structure-access">access</a></span><br>
The created access.</p>
</td></tr></table><h4>Specific errors</h4>
<ul>
<li><code>invalid-item-id</code> <span class="label http">HTTP status</span> <code>400 Bad request</code>: Occurs if trying to set the token to an invalid value (e.g. a reserved word like <code>&quot;null&quot;</code>).</li>
</ul>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section><section class="method"><h3>Update access</h3><div class="content"><p><span class="label http">HTTP</span> <code>PUT /accesses/{id}</code> <span class="label method-id">id</span> <code>accesses.update</code></p>
<p>Modifies the specified shared access. You can only modify accesses whose permissions are a subset of those linked to your own access token.</p>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label http">HTTP</span> Set in request path<br>
The id of the access.</p>
</td></tr><tr><th><p><code>update</code></p>
</th><td><p><span class="type">object</span>
<span class="label http">HTTP</span> = request body<br>
New values for the access&#39;s fields: see <a href="#data-structure-access">access</a>. All fields are optional, and only modified values must be included. TODO: example</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>access</code></p>
</th><td><p><span class="type"><a href="#data-structure-access">access</a></span><br>
The updated access.</p>
</td></tr></table></div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section><section class="method"><h3>Delete access</h3><div class="content"><p><span class="label http">HTTP</span> <code>DELETE /accesses/{id}</code> <span class="label method-id">id</span> <code>accesses.delete</code></p>
<p>Deletes the specified shared access. You can only delete accesses whose permissions are a subset of those linked to your own access token.</p>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label http">HTTP</span> Set in request path<br>
The id of the access.</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>204 No content</code></p>
</div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section></section><section><h2><a id="activity-profile-app"></a>App profile</h2><div class="intro"><p>The app profile is a simple key-value store available for your app to keep user settings. It is exposed as a plain object with free structure. The adding/updating/deleting of settings is designed in the expectation that each setting is a key at the profile object&#39;s root, but you can structure your profile differently if you wish.</p>
<p>The app profile can only be used if authentified with an app access token.</p>
</div><section class="method"><h3>Get app settings</h3><div class="content"><p><span class="label http">HTTP</span> <code>GET /profile/app</code> <span class="label method-id">id</span> <code>profile.getApp</code></p>
<p>Gets your app profile settings.</p>
<h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>profile</code></p>
</th><td><p><span class="type">object</span><br>
Your app&#39;s current profile settings. (Empty if your app never defined any setting.)</p>
</td></tr></table></div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section><section class="method"><h3>Update profile settings</h3><div class="content"><p><span class="label http">HTTP</span> <code>PUT /profile/app</code> <span class="label method-id">id</span> <code>profile.updateApp</code></p>
<p>Adds, updates or delete settings.</p>
<ul>
<li>To add or update a setting, just set its value</li>
<li>To delete a field, set its value to <code>null</code></li>
</ul>
<p>Settings you don&#39;t specify in the update are left untouched.</p>
<h4>Parameters</h4>
<table class="definitions"><tr><th><p><code>update</code></p>
</th><td><p><span class="type">object</span>
<span class="label http">HTTP</span> = request body<br>
An object with the desired changes to the settings (see above).</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>profile</code></p>
</th><td><p><span class="type">object</span><br>
Your app&#39;s updated profile settings.</p>
</td></tr></table></div><aside><h4>Simple example</h4>
<pre><code class="language-json">{
  &quot;keyToAddOrUpdate&quot;: &quot;value&quot;,
  &quot;keyToDelete&quot;: null
}</code></pre>
<h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section></section><section><h2><a id="activity-profile-public"></a>Public profile</h2><div class="intro"><p>The public profile is a simple read-only object exposing publicly shared user information (e.g. avatar image) for use in your app.</p>
</div><section class="method"><h3>Get public info</h3><div class="content"><p><span class="label http">HTTP</span> <code>GET /profile/public</code> <span class="label method-id">id</span> <code>profile.getPublic</code></p>
<p>Gets the user&#39;s public profile info.</p>
<h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>profile</code></p>
</th><td><p><span class="type">object</span><br>
The user&#39;s current public profile information.</p>
</td></tr></table></div><aside><h4>cURL example</h4>
<pre><code class="language-bash">#TODO</code></pre>
</aside></section></section><section><h2>General methods</h2><div class="intro"><p>Methods that don&#39;t pertain to a particular resource type.</p>
</div><section class="method"><h3>Get current access info</h3><div class="content"><p><span class="label http">HTTP</span> <code>GET /access-info</code> <span class="label method-id">id</span> <code>getAccessInfo</code></p>
<p>Retrieves information about the current access.</p>
<h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>name</code></p>
</th><td><p><span class="type">string</span><br>
The current access&#39; name.</p>
</td></tr><tr><th><p><code>type</code></p>
</th><td><p><span class="type">string</span><br>
The current access&#39; type.</p>
</td></tr><tr><th><p><code>permissions</code></p>
</th><td><p><span class="type"><a href="#data-structure-access">access</a>.permissions</span><br>
The current access&#39; permissions.</p>
</td></tr></table></div><aside><h4>cURL example</h4>
<pre><code class="language-bash">curl -i -H &quot;Authorization: {access-token}&quot; https://{username}.pryv.io/access-info</code></pre>
</aside></section><section class="method"><h3>Call batch</h3><div class="content"><p><span class="label http">HTTP</span> <code>POST /</code> <span class="label method-id">id</span> <code>callBatch</code></p>
<p>Calls a batch of API methods.</p>
<h4>Parameters</h4>
<p>Array of method call objects, each defined as follows:</p>
<table class="definitions"><tr><th><p><code>method</code></p>
</th><td><p><span class="type">string</span><br>
The method id.</p>
</td></tr><tr><th><p><code>params</code></p>
</th><td><p><span class="type">object or array</span><br>
The call parameters as required by the method.</p>
</td></tr></table><h4>Response</h4>
<p><span class="label http">HTTP status</span> <code>200 OK</code></p>
<table class="definitions"><tr><th><p><code>results</code></p>
</th><td><p><span class="type">array of call results</span><br>
The results of each method call, in order.</p>
</td></tr></table></div><aside><h4>cURL example</h4>
<p>Save a combination of blood pressures and heart rate.</p>
<pre><code class="language-bash">curl -i -H &quot;Content-Type: application/json&quot; -X POST -d &#39;[
  {
    &quot;methodId&quot;: &quot;events.create&quot;,
    &quot;params&quot;: {
      &quot;time&quot;: 1385046854.282,
      &quot;streamId&quot;: &quot;heart&quot;,
      &quot;type&quot;: &quot;frequency/bpm&quot;,
      &quot;content&quot;: 90
    }
  },
  {
    &quot;methodId&quot;: &quot;events.create&quot;,
    &quot;params&quot;: {
      &quot;time&quot;: 1385046854.282,
      &quot;streamId&quot;: &quot;systolic&quot;,
      &quot;type&quot;: &quot;pressure/mmhg&quot;,
      &quot;content&quot;: 120
    }
  },
  {
    &quot;methodId&quot;: &quot;events.create&quot;,
    &quot;params&quot;: {
      &quot;time&quot;: 1385046854.282,
      &quot;streamId&quot;: &quot;diastolic&quot;,
      &quot;type&quot;: &quot;pressure/mmhg&quot;,
      &quot;content&quot;: 80
    }
  }
]&#39; &quot;https://$USERNAME.pryv.io/?auth=$TOKEN&quot;</code></pre>
<h4>Example response</h4>
<pre><code class="language-json">{
  &quot;results&quot;: [
    {&quot;event&quot;: {...}},
    {&quot;event&quot;: {...}},
    {&quot;event&quot;: {...}}
  ]
}</code></pre>
</aside></section></section></section><section id="socketio"><h1>Socket.IO support</h1><div class="intro"><p>The activity service supports real-time interaction with <a href="http://socket.io">Socket.IO</a>, both by accepting equivalent messages for most API methods and by emitting data change notification messages. (Code examples below are in Javascript.)</p>
</div><section><h3>Connecting</h3><div class="content"><p>In order to use Socket.IO, your app must first load the appropriate Socket.IO client library. For a Javascript web app, that&#39;s the <code>socket.io.js</code> file served by the activity server at the following URL: <code>https://{username}.pryv.io/socket.io/socket.io.js</code>. (For other languages see the related section on the <a href="https://github.com/learnboost/socket.io/wiki">Socket.IO wiki</a>.)</p>
<p>The second step is to initialize the connection. Here&#39;s the URL you need to use:</p>
<pre><code>https://{username}.pryv.io:443/{username}?auth={accessToken}&amp;resource=/{username}</code></pre>
</div><aside><p>For example, in Javascript do:</p>
<pre><code class="language-javascript">var socket = io.connect(&quot;https://mathurin.pryv.io:443/mathurin?auth=TVVro8e8T5&amp;resource=/mathurin&quot;)</code></pre>
</aside></section><section><h3>Calling API methods</h3><div class="content"><p>Every method in the activity service can be called by sending a corresponding Socket.IO <code>{method-id}</code> message, passing a parameters object, and a callback function for the response:</p>
<pre><code class="language-javascript">socket.emit(&#39;{method-id}&#39;, {/*parameters*/}, function (error, data) {
  // handle response here
});</code></pre>
<p>Method ids are indicated for each API method and are modeled after the equivalent URL path.</p>
</div><aside><p>Here&#39;s how you could retrieve events:</p>
<pre><code class="language-javascript">socket.emit(&#39;events.get&#39;, {sortAscending: true}, function (error, data) {
  // handle response
});</code></pre>
</aside></section><section><h3>Receiving data change notifications</h3><div class="content"><p>You can be notified of changes to streams and events by subscribing to the corresponding messages <code>streamsChanged</code>, and <code>eventsChanged</code>.</p>
</div><aside><p>For example:</p>
<pre><code class="language-javascript">socket.on(&#39;eventsChanged&#39;, function() {
  // ... (retrieve latest changes and update)
});</code></pre>
</aside></section></section><section id="data-structure"><h1>Data structure</h1><div class="intro"><p>This section describes the structure of the different types of objects and values exchanged in the API.</p>
<p>Notes:</p>
<ul>
<li>&quot;Read-only&quot; = server-assigned, never set or modified by clients</li>
<li>We should and will reformat items structure for quick visual parsing (e.g. using tables, or at least coloured labels for stuff like &quot;optional&quot;)—for the moment we&#39;ve consciously chosen low-formatting, quick-to-edit bullet lists</li>
</ul>
</div><section><h2><a id="data-structure-event"></a>Event</h2><div class="content"><p>See also: <a href="concepts.html#core-events">core concepts</a>.</p>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label unique">unique</span>
<span class="label read-only">read-only</span><br>
The server-assigned identifier for the event.</p>
</td></tr><tr><th><p><code>streamId</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span><br>
The id of the belonging stream.</p>
</td></tr><tr><th><p><code>time</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span><br>
The event&#39;s time. For period events, this is the time the event started.</p>
</td></tr><tr><th><p><code>duration</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a> difference</span>
<span class="label optional">optional</span><br>
If present, indicates that the event is a period event. <strong>Running period events have a duration set to <code>null</code></strong>. (We use a dedicated field for duration—instead of using the <code>content</code> field—as we do specific processing of event durations, intervals and overlapping.)</p>
</td></tr><tr><th><p><code>type</code></p>
</th><td><p><span class="type">string</span><br>
The type of the event. See the <a href="event-typez.html#directory">event type directory</a> for a list of standard types.</p>
</td></tr><tr><th><p><code>content</code></p>
</th><td><p><span class="type">any type</span>
<span class="label optional">optional</span><br>
The <code>type</code>-specific content of the event, if any.</p>
</td></tr><tr><th><p><code>tags</code></p>
</th><td><p><span class="type">array of strings</span>
<span class="label optional">optional</span> (always present in read items)<br>
The tags associated with the event.</p>
</td></tr><tr><th><p><code>references</code></p>
</th><td><p><span class="type">array of <a href="#data-structure-identity">identity</a></span>
<span class="label optional">optional</span> (always present in read items)<br>
Other events associated with the event. <em>Note: event references aren&#39;t yet implemented in the API today.</em></p>
</td></tr><tr><th><p><code>description</code></p>
</th><td><p><span class="type">string</span>
<span class="label optional">optional</span><br>
User description or comment for the event.</p>
</td></tr><tr><th><p><code>attachments</code></p>
</th><td><p><span class="type">object</span>
<span class="label optional">optional</span>
<span class="label read-only">read-only</span><br>
An object describing the files attached to the event. Each of its properties corresponds to one file and has the following structure:</p>
<table class="definitions"><tr><th><p><code>fileName</code></p>
</th><td><p><span class="type">string</span><br>
The file&#39;s name. The attached file&#39;s URL is obtained by appending this file name to the event&#39;s resource URL.</p>
</td></tr><tr><th><p><code>type</code></p>
</th><td><p><span class="type">string</span><br>
The MIME type of the file.</p>
</td></tr><tr><th><p><code>size</code></p>
</th><td><p><span class="type">number</span><br>
The size of the file, in bytes.</p>
</td></tr></table></td></tr><tr><th><p><code>clientData</code></p>
</th><td><p><span class="type"><a href="#data-structure-additional-data">additional item data</a></span>
<span class="label optional">optional</span><br>
Additional client data for the event.</p>
</td></tr><tr><th><p><code>trashed</code></p>
</th><td><p><span class="type">boolean</span>
<span class="label optional">optional</span><br>
<code>true</code> if the event is in the trash.</p>
</td></tr><tr><th><p><code>created</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label read-only">read-only</span><br>
The time the event was created.</p>
</td></tr><tr><th><p><code>createdBy</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label read-only">read-only</span><br>
The id of the access used to create the event.</p>
</td></tr><tr><th><p><code>modified</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label read-only">read-only</span><br>
The time the event was last modified.</p>
</td></tr><tr><th><p><code>modifiedBy</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label read-only">read-only</span><br>
The id of the last access used to modify the event.</p>
</td></tr></table></div><aside><h4>Example (TODO: update)</h4>
<pre><code class="language-javascript">[
  { &quot;time&quot;: 1350365877.359, &quot;description&quot; : &quot;Some pics&quot;, &quot;id&quot; : &quot;event_0&quot;, &quot;streamId&quot; : null,
    &quot;tags&quot;: [&quot;foraging&quot;, &quot;funny&quot;],
    &quot;type&quot;: &quot;picture/attached&quot;,
    &quot;attachments&quot; : {
      &quot;Gina&quot;: { &quot;fileName&quot;: &quot;gina.jpeg&quot;, &quot;type&quot;: &quot;image/jpeg&quot;, &quot;size&quot;: 1236701 },
      &quot;Enzo&quot;: { &quot;fileName&quot;: &quot;enzo.jpeg&quot;, &quot;type&quot;: &quot;image/jpeg&quot;, &quot;size&quot;: 1127465 }},
    &quot;modified&quot; : 1350463077.359 },
  { &quot;time&quot; : 1350369477.359, &quot;duration&quot; : 7140, &quot;description&quot;: &quot;A period of work&quot;,
    &quot;id&quot; : &quot;event_1&quot;, &quot;streamId&quot; : &quot;free-veggies&quot;,
    &quot;tags&quot;: [&quot;proposal&quot;],
    &quot;type&quot;: &quot;activity/pryv&quot;,
    &quot;modified&quot; : 1350369477.359 },
  { &quot;time&quot; : 1350373077.359, &quot;description&quot; : &quot;A position&quot;, &quot;id&quot; : &quot;event_2&quot;, &quot;streamId&quot; : null,
    &quot;tags&quot;: [],
    &quot;type&quot;: &quot;position/wgs84&quot;,
    &quot;content&quot;: { &quot;latitude&quot;: 40.714728, &quot;longitude&quot;: -73.998672 },
    &quot;modified&quot; : 1350373077.359 }
]</code></pre>
</aside></section><section><h2><a id="data-structure-stream"></a>Stream</h2><div class="content"><p>See also: <a href="concepts.html#core-streams">core concepts</a>.</p>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label unique">unique</span>
<span class="label read-only">read-only</span> (except at creation)<br>
The identifier for the stream. Automatically generated if not set when creating the stream; <strong>slugified if necessary</strong>.</p>
</td></tr><tr><th><p><code>name</code></p>
</th><td><p><span class="type">string</span><br>
A name identifying the stream for users. The name must be unique among the stream&#39;s siblings in the streams tree structure.</p>
</td></tr><tr><th><p><code>parentId</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label optional">optional</span><br>
The identifier of the stream&#39;s parent, if any. A value of <code>null</code> indicates that the stream has no parent (i.e. root stream).</p>
</td></tr><tr><th><p><code>singleActivity</code></p>
</th><td><p><span class="type">boolean</span>
<span class="label optional">optional</span><br>
If specified and <code>true</code>, the system will ensure that period events in this stream and its children never overlap.</p>
</td></tr><tr><th><p><code>clientData</code></p>
</th><td><p><span class="type"><a href="#data-structure-additional-data">item additional data</a></span>
<span class="label optional">optional</span><br>
Additional client data for the stream.</p>
</td></tr><tr><th><p><code>children</code></p>
</th><td><p><span class="type">array of streams</span>
<span class="label read-only">read-only</span><br>
The stream&#39;s sub-streams, if any. This field cannot be set in requests creating a new streams: streams are created individually by design.</p>
</td></tr><tr><th><p><code>trashed</code></p>
</th><td><p><span class="type">boolean</span>
<span class="label optional">optional</span><br>
<code>true</code> if the stream is in the trash.</p>
</td></tr><tr><th><p><code>created</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label read-only">read-only</span><br>
The time the stream was created.</p>
</td></tr><tr><th><p><code>createdBy</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label read-only">read-only</span><br>
The id of the access used to create the stream.</p>
</td></tr><tr><th><p><code>modified</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label read-only">read-only</span><br>
The time the stream was last modified.</p>
</td></tr><tr><th><p><code>modifiedBy</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label read-only">read-only</span><br>
The id of the last access used to modify the stream.</p>
</td></tr></table></div><aside><h4>Example (TODO: update)</h4>
<p>A stream structure for activities:</p>
<pre><code class="language-javascript">[
  { &quot;name&quot;: &quot;Sport&quot;, &quot;id&quot;: &quot;sport&quot;, &quot;parentId&quot;: null,
    &quot;children&quot;: [
      { &quot;name&quot;: &quot;Jogging&quot;, &quot;id&quot;: &quot;jogging&quot;, &quot;parentId&quot;: &quot;sport&quot;, &quot;children&quot;: [] },
      { &quot;name&quot;: &quot;Bicycling&quot;, &quot;id&quot;: &quot;bicycling&quot;, &quot;parentId&quot;: &quot;sport&quot;, &quot;children&quot;: [] }
  ]},
  { &quot;name&quot;: &quot;Work&quot;, &quot;id&quot;: &quot;work&quot;, &quot;parentId&quot;: null,
    &quot;children&quot;: [
      { &quot;name&quot;: &quot;Noble Works Co.&quot;, &quot;id&quot;: &quot;noble-works&quot;,&quot;parentId&quot;: &quot;work&quot;, &quot;children&quot;: [
          { &quot;name&quot;: &quot;Last Be First&quot;, &quot;id&quot;: &quot;last-be-first&quot;,&quot;parentId&quot;: &quot;noble-works&quot;, &quot;children&quot;: [] },
          { &quot;name&quot;: &quot;Big Tree&quot;, &quot;id&quot;: &quot;big-tree&quot;,&quot;parentId&quot;: &quot;noble-works&quot;, &quot;children&quot;: [] },
          { &quot;name&quot;: &quot;Inner Light&quot;, &quot;id&quot;: &quot;inner-light&quot;,&quot;parentId&quot;: &quot;noble-works&quot;, &quot;children&quot;: [] }
      ]},
      { &quot;name&quot;: &quot;Freelancing&quot;, &quot;id&quot;: &quot;freelancing&quot;,&quot;parentId&quot;: &quot;work&quot;, &quot;children&quot;: [
          { &quot;name&quot;: &quot;Funky Veggies&quot;, &quot;id&quot;: &quot;funky-veggies&quot;,&quot;parentId&quot;: &quot;freelancing&quot;, &quot;children&quot;: [] },
          { &quot;name&quot;: &quot;Jojo Lapin &amp; sons&quot;, &quot;id&quot;: &quot;jojo-lapin&quot;,&quot;parentId&quot;: &quot;freelancing&quot;, &quot;children&quot;: [] }
      ]}
    ]
  }
];</code></pre>
</aside></section><section><h2><a id="data-structure-tag"></a>Tag</h2><div class="content"><p>Tags can be plain text or typed tags; this describes the latter. See also: <a href="concepts.html#core-tags">core concepts</a>.
<em>Note: typed tags aren&#39;t yet implemented in the API today.</em></p>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label unique">unique</span>
<span class="label read-only">read-only</span><br>
The identifier for the tag.</p>
</td></tr><tr><th><p><code>type</code></p>
</th><td><p><span class="type">string</span><br>
The type of the tag. See the <a href="#TODO">tag type directory</a> for a list of standard types.</p>
</td></tr><tr><th><p><code>content</code></p>
</th><td><p><span class="type">any type</span>
<span class="label optional">optional</span><br>
The <code>type</code>-specific content of the tag, if any.</p>
</td></tr><tr><th><p><code>clientData</code></p>
</th><td><p><span class="type"><a href="#data-structure-additional-data">additional item data</a></span>
<span class="label optional">optional</span><br>
Additional client data for the tag.</p>
</td></tr><tr><th><p><code>trashed</code></p>
</th><td><p><span class="type">boolean</span>
<span class="label optional">optional</span><br>
<code>true</code> if the tag is in the trash.</p>
</td></tr><tr><th><p><code>created</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label read-only">read-only</span><br>
The time the tag was created.</p>
</td></tr><tr><th><p><code>createdBy</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label read-only">read-only</span><br>
The id of the access used to create the tag.</p>
</td></tr><tr><th><p><code>modified</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label read-only">read-only</span><br>
The time the tag was last modified.</p>
</td></tr><tr><th><p><code>modifiedBy</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label read-only">read-only</span><br>
The id of the last access used to modify the tag.</p>
</td></tr></table></div><aside><p>TODO: example</p>
</aside></section><section><h2><a id="data-structure-access"></a>Access</h2><div class="content"><p>See also: <a href="concepts.html#core-accesses">core concepts</a>.</p>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label unique">unique</span>
<span class="label read-only">read-only</span><br>
The identifier for the access.</p>
</td></tr><tr><th><p><code>token</code></p>
</th><td><p><span class="type">string</span>
<span class="label unique">unique</span>
<span class="label read-only">read-only</span> (except at creation)<br>
The token identifying the access. Automatically generated if not set when creating the access; <strong>slugified if necessary</strong>.</p>
</td></tr><tr><th><p><code>type</code></p>
</th><td><p><span class="type"><code>&quot;personal&quot;</code>|<code>&quot;app&quot;</code>|<code>&quot;shared&quot;</code></span>
<span class="label optional">optional</span><br>
The type — or usage — of the access. Default: <code>&quot;shared&quot;</code>.</p>
</td></tr><tr><th><p><code>name</code></p>
</th><td><p><span class="type">string</span>
<span class="label unique">unique</span> <em>per type and device name (if defined)</em><br>
The name identifying the access for the user. (Note that for personal and app access, the name is used as a technical identifier and not shown as-is to the user.)</p>
</td></tr><tr><th><p><code>deviceName</code></p>
</th><td><p><span class="type">string</span>
<span class="label optional">optional</span>
<span class="label unique">unique</span> <em>per type and name (if defined)</em><br>
For app accesses only. The name of the client device running the app, if applicable.</p>
</td></tr><tr><th><p><code>permissions</code></p>
</th><td><p><span class="type">array of permission objects</span><br>
Ignored for personal accesses. Shared accesses are only granted access to activity data objects listed in here. Each permission object has the following structure:</p>
<table class="definitions"><tr><th><p><code>streamId</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span><br>
The accessible stream&#39;s id, or <code>&quot;*&quot;</code> for &quot;all streams&quot;. If the stream has child streams, they will be accessible too.</p>
</td></tr><tr><th><p><code>level</code></p>
</th><td><p><span class="type"><code>&quot;read&quot;</code>|<code>&quot;contribute&quot;</code>|<code>&quot;manage&quot;</code></span><br>
The level of access to the stream. With <code>&quot;contribute&quot;</code>, the access&#39;s token holder(s) can see and record events for the stream (and its child streams, if any); with <code>&quot;manage&quot;</code>, the access&#39;s token holder(s) can in addition create, modify and delete child streams.</p>
</td></tr></table></td></tr><tr><th><p><code>created</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label read-only">read-only</span><br>
The time the access was created.</p>
</td></tr><tr><th><p><code>createdBy</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label read-only">read-only</span><br>
The id of the access used to create this access.</p>
</td></tr><tr><th><p><code>modified</code></p>
</th><td><p><span class="type"><a href="#data-structure-timestamp">timestamp</a></span>
<span class="label read-only">read-only</span><br>
The time the access was last modified.</p>
</td></tr><tr><th><p><code>modifiedBy</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label read-only">read-only</span><br>
The id of the last access used to modify this access.</p>
</td></tr></table><p>A note about permissions: if the access defines conflicting permission levels (e.g. a stream set to &quot;manage&quot; but a child stream within it set to &quot;contribute&quot;), only the highest level is considered.</p>
</div><aside><p>TODO: example</p>
</aside></section><section><h2><a id="data-structure-bookmark"></a>Subscriptions (a.k.a. bookmarks)</h2><div class="content"><p>See also: <a href="concepts.html#core-subscriptions">core concepts</a>.</p>
<table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span>
<span class="label unique">unique</span>
<span class="label read-only">read-only</span><br>
The server-assigned identifier for the subscription.</p>
</td></tr><tr><th><p><code>name</code></p>
</th><td><p><span class="type">string</span>
<span class="label unique">unique</span><br>
A name identifying the subscription for the user.</p>
</td></tr><tr><th><p><code>url</code></p>
</th><td><p><span class="type">string</span><br>
The url pointing to the shared access&#39;s owning user&#39;s server. Not modifiable after creation.</p>
</td></tr><tr><th><p><code>accessToken</code></p>
</th><td><p><span class="type"><a href="#data-structure-identity">identity</a></span><br>
The token of the shared access itself. Not modifiable after creation.</p>
</td></tr></table></div><aside><p>TODO: example</p>
</aside></section><section><h2><a id="data-structure-additional-data"></a>Item additional data</h2><div class="content"><p>An object (key-value map) for client apps to store additional data about the containing item (stream, event, etc.), such as a color, a reference to an associated icon, or other app-specific metadata.</p>
<h3>Adding, updating and removing client data</h3>
<p>When the containing item is updated, additional data fields can be added, updated and removed as follows:</p>
<ul>
<li>To add or update a field, just set its value; for example: <code>{&quot;clientData&quot;: {&quot;keyToAddOrUpdate&quot;: &quot;value&quot;}}</code></li>
<li>To delete a field, set its value to <code>null</code>; for example: <code>{&quot;clientData&quot;: {&quot;keyToDelete&quot;: null}}</code></li>
</ul>
<p>Fields you don&#39;t specify in the update are left untouched.</p>
<h3>Naming convention</h3>
<p>The convention is that each app names the keys it uses with an <code>&quot;{app-id}:&quot;</code> prefix. For example, an app with id &quot;riki&quot; would store its data in fields such as <code>&quot;riki:key&quot;: &quot;some value&quot;</code>.</p>
</div></section><section><h2><a id="data-structure-error"></a>Error</h2><div class="content"><table class="definitions"><tr><th><p><code>id</code></p>
</th><td><p><span class="type">string</span><br>
Identifier for the error; complements the response&#39;s HTTP error code.</p>
</td></tr><tr><th><p><code>message</code></p>
</th><td><p><span class="type">string</span><br>
A human-readable description of the error.</p>
</td></tr><tr><th><p><code>subErrors</code></p>
</th><td><p><span class="type">array of errors</span>
<span class="label optional">optional</span><br>
Lists the detailed causes of the main error, if any.</p>
</td></tr></table></div><aside><p>TODO: example</p>
</aside></section><section><h2>Simple types</h2><section><h3><a id="data-structure-identity"></a>Item identity</h3><div class="content"><p>A string value uniquely identifying an item of a given type (e.g. stream, event) for a given user. For some types of items (&quot;structural&quot; ones such as streams), it is allowed for the identity to be optionally set by API clients; otherwise the identity is generated by the server as an alphanumeric string.</p>
</div></section><section><h3><a id="data-structure-timestamp"></a>Timestamp</h3><div class="content"><p>A positive floating-point number representing a number of seconds since any reference date and time, <strong>independently from the time zone</strong>. Because date and time synchronization between server time and client time is done by the client simply comparing the current server timestamp with its own, the reference date and time does not actually matter (but our servers do use standard Unix epoch time).</p>
</div><aside><p>Some examples of getting a valid timestamp in various environments:</p>
<ul>
<li>JavaScript: <code>Date.now() / 1000</code></li>
<li>PHP (5+): <code>microtime(true)</code></li>
<li>TODO: more examples</li>
</ul>
</aside></section><section><h3><a id="data-structure-language-code"></a>Two-letter ISO language code</h3><div class="content"><p>A two-letter string specifying a language following the ISO 639-1 standard (see <a href="http://en.wikipedia.org/wiki/ISO_639-1">the related Wikipedia definition</a>).</p>
</div></section></section></section></div><div id="toc"></div><script>jQuery(document).ready(function($) {
  $('#toc').toc({
    'selectors': 'h1,h2',
    'container': '#main',
    'smoothScrolling': false,
    'prefix': 'toc',
    'onHighlight': function(el) {},
    'highlightOnScroll': true,
    'highlightOffset': 100,
    'anchorName': function(i, heading, prefix) {
      var $heading = $(heading),
          sectionId = $heading.parents('section[id]').attr('id');
      return sectionId + ($heading.is('h1') ? '' : '-' + slugify($heading.text()));
    },
    'headerText': function(i, heading, $heading) {
      return $heading.text();
    }
  });
  
  function slugify(text) {
    return text.toLowerCase().replace(/[^\w- ]+/g,'').replace(/ +/g,'-');
  }
});</script></div></body></html>